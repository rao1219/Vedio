{
  "name": "sequelize-fixtures",
  "version": "0.4.7",
  "description": "sequelize fixture loader",
  "main": "index.js",
  "scripts": {
    "test": "rm -f ./testdb.sqlite && ./node_modules/.bin/mocha tests"
  },
  "engines": {
    "node": "*"
  },
  "keywords": [
    "sequelize",
    "fixtures"
  ],
  "dependencies": {
    "bluebird": "^2.4.2",
    "glob": "~3.2.1",
    "js-yaml": "~2.1.0"
  },
  "devDependencies": {
    "mocha": "*",
    "sequelize": "*",
    "should": "*",
    "sinon": "^1.14.1",
    "sqlite3": "*"
  },
  "repository": {
    "type": "git",
    "url": "git://github.com/domasx2/sequelize-fixtures.git"
  },
  "bugs": {
    "url": "https://github.com/domasx2/sequelize-fixtures/issues"
  },
  "author": {
    "name": "Domas Lapinskas",
    "email": "domasx2@gmail.com"
  },
  "license": "BSD",
  "readmeFilename": "README.md",
  "readme": "[![Build Status](https://travis-ci.org/domasx2/sequelize-fixtures.svg?branch=master)](https://travis-ci.org/domasx2/sequelize-fixtures)\n\nSequelize fixtures\n==========================================\n\nThis is a simple lib to load data to database using sequelize.  \nIt is intended for easily setting up test data.  \nYaml and json formats are supported. Includes a grunt task.  \nDuplicate records are not insertd.\nAPI returns bluebird promises, but callbacks can also be used as the last argument.  \n\nTested with latest Sequelize (3.0.0), should work on 2.x.\n\n### Install\n    \n    npm install sequelize-fixtures\n\n### Test\n    \n    npm test\n\n### Usage\n\n```javascript\n    var sequelize_fixtures = require('sequelize-fixtures'),\n        models = {\n            Foo: require('./models/Foo')\n        };\n\n    //from file\n    sequelize_fixtures.loadFile('fixtures/test_data.json', models).then(function(){\n        doStuffAfterLoad();\n    });\n\n    //can use glob syntax to select multiple files\n    sequelize_fixtures.loadFile('fixtures/*.json', models).then(function(){\n        doStuffAfterLoad();\n    });\n\n    //array of files\n    sequelize_fixtures.loadFiles(['fixtures/users.json', 'fixtures/data*.json'], models).then(function(){\n        doStuffAfterLoad();\n    });\n\n    //specify file encoding (default utf8)\n    sequelize_fixtures.loadFile('fixtures/*.json', models, { encoding: 'windows-1257'}).then(function(){\n        doStuffAfterLoad();\n    });\n\n    //load fixtures inside a transaction\n    sequelize.transaction(function(tx) {\n        sequelize_fixtures.loadFile('fixtures/*.json', models, { transaction: tx}).then(doStuffAfterLoad);\n    });\n    \n    //apply transform for each model being loaded\n    sequelize_fixtures.loadFile('fixtures/*.json', models, {\n        transformFixtureDataFn: function (data) {\n          if(data.createdAt \n           && data.createdAt < 0) { \n            data.createdAt = new Date((new Date()).getTime() + parseFloat(data.createdAt) * 1000 * 60);\n          }\n          return data;\n        }\n    }).then(function() {\n        doStuffAfterLoad();\n    });\n\n    //from array\n    var fixtures = [\n        {\n            model: 'Foo',\n            data: {\n                propA: 'bar',\n                propB: 1\n            }\n        },\n        {\n            model: 'Foo',\n            data: {\n                propA: 'baz',\n                propB: 3\n            }\n        }\n    ];\n    sequelize_fixtures.loadFixtures(fixtures, models).then(function(){\n        doStuffAfterLoad();\n    });\n```\n\n### File formats\n\n#### json\n\n```json\n    [\n        {\n            \"model\": \"Foo\",\n            \"data\": {\n                \"propA\": \"bar\",\n                \"propB\": 1\n            }\n        },\n        {\n            \"model\": \"Foo\",\n            \"data\": {\n                \"propA\": \"baz\",\n                \"propB\": 3\n            }\n        }\n    ]\n```\n\n#### yaml\n\n```yaml\n    fixtures:\n        - model: Foo\n          data:\n            propA: bar\n            propB: 1\n        - model: Foo\n          data:\n            propA: baz\n            propB: 3\n```\n\n\n#### javascript\n\n```javascript\n    module.exports = [\n        {\n            \"model\": \"Foo\",\n            \"data\": {\n                \"propA\": \"bar\",\n                \"propB\": 1\n            }\n        },\n        {\n            \"model\": \"Foo\",\n            \"data\": {\n                \"propA\": \"baz\",\n                \"propB\": 3\n            }\n        }\n    ];\n```\n\n\n### Associations \n\nYou can specify associations by providing related object id or a where clause to select associated object with. Make sure associated objects are described before associations!\n\n#### One to many\n\nAssuming \n```javascript\nCar.belongsTo(Owner);\nOwner.hasMany(Car);\n```\nAssociated entity can be mapped by providing either an id:  \n\n```json\n[\n    {\n        \"model\": \"Owner\",\n        \"data\": {\n            \"id\": 11,\n            \"name\": \"John Doe\",\n            \"city\": \"Vilnius\"\n        }\n    },\n    {\n        \"model\": \"Car\",\n        \"data\": {\n            \"id\": 203,\n            \"make\": \"Ford\",\n            \"owner\": 11\n        }\n    }\n]\n```\n\nOr a property-value map (like a 'where' object) to find the entity with:  \n\n```json\n[\n    {\n        \"model\": \"Owner\",\n        \"data\": {\n            \"name\": \"John Doe\",\n            \"city\": \"Vilnius\"\n        }\n    },\n    {\n        \"model\": \"Car\",\n        \"data\": {\n            \"make\": \"Ford\",\n            \"owner\": {\n                \"name\": \"John Doe\" \n            }\n        }\n    }\n]\n```\n\n#### Many to many\n\nAssuming \n\n```javascript\nProject.belongsToMany(Person, {through: 'peopleprojects'});\nPerson.belongsToMany(Project, {through: 'peopleprojects'});\n```\n\nAssociated entities can be mapped using the association 'as' name ('people' for Project and 'projects' for People) or 'through' table name, and providing an array of ids:\n\n```json\n[\n    {\n        \"model\":\"Person\",\n        \"data\":{\n            \"id\":122,\n            \"name\": \"Jack\",\n            \"role\": \"Developer\"\n        }\n    },\n    {\n        \"model\":\"Person\",\n        \"data\":{\n            \"id\": 123,\n            \"name\": \"John\",\n            \"role\": \"Analyst\"\n        }\n    },\n    {\n        \"model\":\"Project\",\n        \"data\": {\n            \"id\": 20,\n            \"name\": \"The Great Project\",\n            \"people\": [122, 123]\n        }\n    }\n\n]\n```\n\nOr an array of property-value mappings to find the entities with:\n\n\n```json\n[\n    {\n        \"model\":\"Person\",\n        \"data\":{\n            \"name\": \"Jack\",\n            \"role\": \"Developer\"\n        }\n    },\n    {\n        \"model\":\"Person\",\n        \"data\":{\n            \"name\": \"John\",\n            \"role\": \"Analyst\"\n        }\n    },\n    {\n        \"model\":\"Project\",\n        \"data\": {\n            \"name\": \"The Great Project\",\n            \"people\": [\n                {                        \n                    \"name\": \"Jack\"\n                },\n                {\n                    \"name\": \"John\"\n                }\n            ]\n        }\n    }\n\n]\n```\n\n#### Build options, save optons\n\nFor each model you can provide build options that are passed to Model.build() and save options that are passed to instance.save(), example:\n\n```json\n{\n    \"model\": \"Article\",\n    \"buildOptions\": { \n        \"raw\": true, \n        \"isNewRecord\": true\n    },\n    \"saveOptions\": { \n        \"fields\": [\"title\", \"body\"] \n    },\n    \"data\": {\n        \"title\": \"Any title\",\n        \"slug\": \"My Invalid Slug\"\n    }\n}\n\n```\n\n#### Detect duplicates based on select fields\n\nIn case you want to detect duplicates based on specific field or fields rather than all fields (for example, don't include entities with the same id, even if other fields don't match), you can speficy these fields with a 'keys' property.\n\n```json\n{\n    \"model\": \"Person\",\n    \"keys\": [\"email\"],\n    \"data\": {\n        \"name\": \"John\",\n        \"email\": \"example@example.com\"\n    }\n},\n{\n    \"model\": \"Person\",\n    \"keys\": [\"email\"],\n    \"data\": {\n        \"name\": \"Patrick\",\n        \"email\": \"example@example.com\"\n    }\n}\n\n```\nIn this example only John will be loaded\n\n\n# grunt task\n\nGruntfile.js:\n\n```javascript\n    grunt.initConfig({\n        fixtures: {\n            import_test_data: {\n                src: ['fixtures/data1.json', 'fixtures/models*.json'],\n                models: function () {  //returns mapping model name: model\n                    return require('../models') \n                },\n                options: { //specify encoding, optiona. default utf-8\n                    encoding: 'windows-1257'\n                }\n            }\n        }\n\n    });\n\n    grunt.loadNpmTasks('sequelize-fixtures');\n```",
  "homepage": "https://github.com/domasx2/sequelize-fixtures#readme",
  "_id": "sequelize-fixtures@0.4.7",
  "_from": "sequelize-fixtures@*"
}
